#!/usr/bin/env python

import readline
import code
import numpy as np
from sys import argv, exit
from PandaCore.Tools.Misc import logger
from argparse import ArgumentParser 

parser = ArgumentParser(description='pyroot load')
parser.add_argument('--verbose', action='store_true')
parser.add_argument('--python', action='store_true')
parser.add_argument('files', type=str, nargs='+')
args = parser.parse_args()

argv = []
import PandaCore.Tools.root_interface as ri 
import ROOT as root

data = {}
for fpath in args.files:
    data[fpath] = root.TFile.Open(fpath)
    if args.verbose:
        logger.info('pyroot', fpath)

if len(data) == 1:
    d = data.values()[0]
else:
    d = data

if args.python:
    vars = globals().copy()
    vars.update(locals())
    shell = code.InteractiveConsole(vars)
    shell.interact()
else:
    try:
        from IPython import embed
        embed()
    except ImportError as e:
        logger.error('npy', 'IPython not found, try passing --python for bare python shell')
        exit(1)
